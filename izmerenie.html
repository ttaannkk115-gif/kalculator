<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#121212">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Master ToolBox Ultra</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">
    
    <style>
        :root {
            --bg: #121212;
            --card: #1e1e1e;
            --accent: #ff9800;
            --accent-blue: #00bcd4;
            --accent-purple: #9c27b0;
            --accent-pink: #e91e63;
            --text: #e0e0e0;
            --input-bg: #2c2c2c;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 10px;
            overscroll-behavior: none;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .tabs {
            display: flex;
            background: var(--card);
            border-radius: 12px;
            margin-bottom: 15px;
            padding: 5px;
            position: sticky;
            top: 5px;
            z-index: 100;
            overflow-x: auto;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            -webkit-overflow-scrolling: touch;
        }

        .tabs::-webkit-scrollbar { display: none; }

        .tab-btn {
            flex: 1;
            min-width: 85px;
            padding: 12px 5px;
            border: none;
            background: none;
            color: #888;
            font-size: 0.7rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 8px;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .tab-btn.active { background: var(--accent); color: #000; }

        .content { display: none; }
        .content.active { display: block; animation: fadeIn 0.2s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card {
            background: var(--card);
            border-radius: 15px;
            padding: 18px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        h2 { color: var(--accent); font-size: 1rem; margin: 0 0 15px 0; border-bottom: 1px solid #333; padding-bottom: 8px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        label { display: block; font-size: 0.7rem; color: #888; margin-bottom: 4px; }
        
        input, select { 
            width: 100%; 
            padding: 14px; 
            border-radius: 8px; 
            border: 2px solid #333; 
            background: var(--input-bg); 
            color: white; 
            box-sizing: border-box; 
            font-size: 1rem; 
            outline: none;
            transition: border-color 0.2s;
        }

        input:focus { border-color: var(--accent); }

        button.main-btn { 
            width: 100%; 
            padding: 16px; 
            background: var(--accent); 
            border: none; 
            border-radius: 8px; 
            font-weight: bold; 
            margin-top: 10px; 
            cursor: pointer; 
            color: #000;
            font-size: 1rem;
        }
        
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; margin-top: 10px; }
        th, td { padding: 12px 5px; text-align: center; border-bottom: 1px solid #333; }
        th { color: var(--accent); }

        .res-box { margin-top: 15px; padding: 15px; border-radius: 8px; text-align: center; display: none; }
        .ok { border: 1px solid #4caf50; color: #4caf50; background: rgba(76,175,80,0.1); }
        .warn { border: 1px solid #f44336; color: #f44336; background: rgba(244,67,54,0.1); }
        .hint { font-size: 0.75rem; color: #aaa; margin-top: 10px; line-height: 1.4; }
        
        .b-big { font-size: 1.5rem; font-weight: bold; display: block; margin: 5px 0; }
    </style>
</head>
<body>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab(event, 'breaker')">–ê–≤—Ç–æ–º–∞—Ç</button>
        <button class="tab-btn" onclick="openTab(event, 'ohm')">–û–º</button>
        <button class="tab-btn" onclick="openTab(event, 'wires')">–°–µ—á–µ–Ω–∏–µ</button>
        <button class="tab-btn" onclick="openTab(event, 'loss')">–ü–æ—Ç–µ—Ä–∏</button>
        <button class="tab-btn" onclick="openTab(event, 'motor')">–ú–æ—Ç–æ—Ä</button>
        <button class="tab-btn" onclick="openTab(event, 'light')">–°–≤–µ—Ç/IP</button>
    </div>

    <div id="breaker" class="content active">
        <div class="card">
            <h2>üõ°Ô∏è –ü–æ–¥–±–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∞ (–ê–í)</h2>
            <div class="grid">
                <div><label>–ú–æ—â–Ω–æ—Å—Ç—å (–í—Ç)</label><input type="number" id="b_p" placeholder="3500" class="auto-clear"></div>
                <div><label>–°–µ—Ç—å</label><select id="b_v"><option value="220">220–í (1—Ñ)</option><option value="380">380–í (3—Ñ)</option></select></div>
            </div>
            <button class="main-btn" onclick="calcBreaker()" style="background:var(--accent-blue);">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            <div id="b_res" class="res-box ok">
                <span>–†–∞—Å—á–µ—Ç–Ω—ã–π —Ç–æ–∫: <span id="b_i_real">0</span> –ê</span>
                <span class="b-big" id="b_i_std">--</span>
                <div class="hint">–£—á—Ç–µ–Ω –∑–∞–ø–∞—Å 25% –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã.</div>
            </div>
        </div>
    </div>

    <div id="ohm" class="content">
        <div class="card">
            <h2>‚ö° –ó–∞–∫–æ–Ω –û–º–∞</h2>
            <div class="grid">
                <div><label>U (–í–æ–ª—å—Ç)</label><input type="number" id="o_u" class="auto-clear"></div>
                <div><label>I (–ê–º–ø–µ—Ä)</label><input type="number" id="o_i" class="auto-clear"></div>
                <div><label>R (–û–º)</label><input type="number" id="o_r" class="auto-clear"></div>
                <div><label>P (–í–∞—Ç—Ç)</label><input type="number" id="o_p" class="auto-clear"></div>
            </div>
            <button class="main-btn" onclick="calcOhm()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            <div class="hint">–í–≤–µ–¥–∏—Ç–µ –ª—é–±—ã–µ 2 –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞—Å—Å—á–∏—Ç–∞—é—Ç—Å—è —Å–∞–º–∏.</div>
        </div>
    </div>

    <div id="wires" class="content">
        <div class="card">
            <h2>üîå –ü–æ–¥–±–æ—Ä –∫–∞–±–µ–ª—è (–ü–£–≠)</h2>
            <select id="w_mount" onchange="renderTable()" style="margin-bottom:10px;">
                <option value="open">–û—Ç–∫—Ä—ã—Ç–∞—è –ø—Ä–æ–∫–ª–∞–¥–∫–∞</option>
                <option value="hidden">–°–∫—Ä—ã—Ç–∞—è –ø—Ä–æ–∫–ª–∞–¥–∫–∞ (–≤ —à—Ç—Ä–æ–±–µ)</option>
            </select>
            <div class="grid">
                <select id="w_mat" onchange="renderTable()"><option value="cu">–ú–µ–¥—å</option><option value="al">–ê–ª—é–º.</option></select>
                <select id="w_volt" onchange="renderTable()"><option value="220">220–í</option><option value="380">380–í</option></select>
            </div>
            <table>
                <thead><tr><th>–º–º¬≤</th><th>–¢–æ–∫ (–ê)</th><th>P (–∫–í—Ç)</th></tr></thead>
                <tbody id="w_body"></tbody>
            </table>
        </div>
    </div>

    <div id="loss" class="content">
        <div class="card">
            <h2>üìâ –ü–æ—Ç–µ—Ä–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è</h2>
            <label>–ú–æ—â–Ω–æ—Å—Ç—å (–í—Ç)</label><input type="number" id="l_p" class="auto-clear" placeholder="3000">
            <label style="margin-top:10px;">–î–ª–∏–Ω–∞ –ª–∏–Ω–∏–∏ (–º–µ—Ç—Ä–æ–≤)</label><input type="number" id="l_l" class="auto-clear" placeholder="50">
            <div class="grid" style="margin-top:10px;">
                <select id="l_s"><option value="1.5">1.5 –º–º¬≤</option><option value="2.5" selected>2.5 –º–º¬≤</option><option value="4">4.0 –º–º¬≤</option><option value="6">6.0 –º–º¬≤</option></select>
                <select id="l_m"><option value="0.0175">–ú–µ–¥—å</option><option value="0.028">–ê–ª—é–º.</option></select>
            </div>
            <button class="main-btn" onclick="calcLoss()" style="background:var(--accent-blue);">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å %</button>
            <div id="l_res" class="res-box">
                <span class="b-big" id="l_val">0%</span>
                <div id="l_txt"></div>
            </div>
        </div>
    </div>

    <div id="motor" class="content">
        <div class="card">
            <h2>üåÄ –ü—É—Å–∫ 3–§ –º–æ—Ç–æ—Ä–∞ –≤ 220–í</h2>
            <label>–ú–æ—â–Ω–æ—Å—Ç—å (–∫–í—Ç)</label><input type="number" id="m_p" placeholder="2.2" step="0.1" class="auto-clear">
            <label style="margin-top:10px;">–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</label>
            <select id="m_type"><option value="delta" selected>–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ (Œî)</option><option value="star">–ó–≤–µ–∑–¥–∞ (Y)</option></select>
            <button class="main-btn" onclick="calcMotor()" style="background:var(--accent-purple); color:#fff;">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–∫–§</button>
            <div id="m_res" class="res-box ok">
                <div>–†–∞–±–æ—á–∏–π (–°—Ä): <b id="m_crab"></b></div>
                <div>–ü—É—Å–∫–æ–≤–æ–π (–°–ø): <b id="m_cpusk"></b></div>
            </div>
        </div>
    </div>

    <div id="light" class="content">
        <div class="card">
            <h2>üí° –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å (–ù–æ—Ä–º—ã)</h2>
            <div class="grid">
                <div><label>–ü–ª–æ—â–∞–¥—å (–º¬≤)</label><input type="number" id="li_a" class="auto-clear"></div>
                <div><label>–¢–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è</label><select id="li_t"><option value="150">–ñ–∏–ª–æ–µ (150–ª–∫)</option><option value="300">–û—Ñ–∏—Å (300–ª–∫)</option><option value="50">–°–∫–ª–∞–¥ (50–ª–∫)</option></select></div>
            </div>
            <button class="main-btn" onclick="calcLight()" style="background:var(--accent-pink); color:#fff;">–†–∞—Å—á–µ—Ç —Å–≤–µ—Ç–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞</button>
            <div id="li_res" class="res-box ok">
                <span class="b-big" id="li_v">0 –õ–º</span>
                <div class="hint">–û–±—â–∏–π –ø–æ—Ç–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ª–∞–º–ø.</div>
            </div>
        </div>
        <div class="card">
            <h2>üõ°Ô∏è –°—Ç–µ–ø–µ–Ω—å –∑–∞—â–∏—Ç—ã IP</h2>
            <div class="grid">
                <select id="ip1" onchange="updateIP()"><option value="0">0: –ù–µ—Ç</option><option value="2">2: –ü–∞–ª—å—Ü—ã</option><option value="4">4: –ü—Ä–µ–¥–º–µ—Ç—ã</option><option value="5">5: –ü—ã–ª—å</option><option value="6" selected>6: –ü—ã–ª–µ–Ω–µ–ø—Ä–æ–Ω.</option></select>
                <select id="ip2" onchange="updateIP()"><option value="0">0: –ù–µ—Ç</option><option value="1">1: –ö–∞–ø–ª–∏</option><option value="4">4: –ë—Ä—ã–∑–≥–∏</option><option value="7" selected>7: –ü–æ–≥—Ä—É–∂.</option><option value="8">8: –î–∞–≤–ª–µ–Ω–∏–µ</option></select>
            </div>
            <div id="ip_desc" class="hint" style="text-align:center; color:var(--accent-blue); font-weight:bold; font-size:0.85rem;"></div>
        </div>
    </div>

    <script>
        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –û–ß–ò–°–¢–ö–ê –ü–†–ò –§–û–ö–£–°–ï
        document.querySelectorAll('.auto-clear').forEach(input => {
            input.addEventListener('focus', function() { this.value = ''; });
        });

        // –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –¢–ê–ë–û–í
        function openTab(e, t) {
            let c = document.getElementsByClassName("content"), b = document.getElementsByClassName("tab-btn");
            for (let i=0; i<c.length; i++) { c[i].classList.remove("active"); b[i].classList.remove("active"); }
            document.getElementById(t).classList.add("active"); e.currentTarget.classList.add("active");
            if(t==='wires') renderTable(); if(t==='light') updateIP();
        }

        // –†–ê–°–ß–ï–¢ –ê–í–¢–û–ú–ê–¢–ê
        function calcBreaker() {
            const p = parseFloat(document.getElementById('b_p').value);
            const v = parseFloat(document.getElementById('b_v').value);
            if (!p) return;
            let i = (v == 220) ? (p / v) : (p / (v * 1.732 * 0.9));
            const target = i * 1.25; 
            const ratings = [6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100];
            const std = ratings.find(r => r >= target) || "‚ö†Ô∏è –°–ø–µ—Ü. –∑–∞–∫–∞–∑";
            
            document.getElementById('b_res').style.display = 'block';
            document.getElementById('b_i_real').innerText = i.toFixed(2);
            document.getElementById('b_i_std').innerText = std + (typeof std === 'number' ? ' –ê–º–ø–µ—Ä' : '');
        }

        // –ó–ê–ö–û–ù –û–ú–ê
        function calcOhm() {
            let u=parseFloat(document.getElementById('o_u').value), i=parseFloat(document.getElementById('o_i').value), r=parseFloat(document.getElementById('o_r').value), p=parseFloat(document.getElementById('o_p').value);
            if(u && i){r=u/i; p=u*i} else if(u && r){i=u/r; p=u*u/r} else if(i && r){u=i*r; p=i*i*r} else if(p && u){i=p/u; r=u*u/p}
            if(u) document.getElementById('o_u').value=u.toFixed(1); if(i) document.getElementById('o_i').value=i.toFixed(2); if(r) document.getElementById('o_r').value=r.toFixed(1); if(p) document.getElementById('o_p').value=p.toFixed(0);
        }

        // –¢–ê–ë–õ–ò–¶–ê –ü–£–≠
        const wireData = {
            open: { cu:{s:[1.5,2.5,4,6,10], i:[23,30,41,50,80], p220:[5,6.6,9,11,17], p380:[8.7,11,15,19,30]}, al:{s:[2.5,4,6,10,16], i:[24,32,39,60,75], p220:[5.2,7,8.5,13,16], p380:[9.1,12,14,22,28]} },
            hidden: { cu:{s:[1.5,2.5,4,6,10], i:[15,21,27,34,50], p220:[3.3,4.6,5.9,7.7,11], p380:[5.7,7.9,10,12,19]}, al:{s:[2.5,4,6,10,16], i:[16,21,26,38,55], p220:[3.5,4.6,5.7,8.3,12], p380:[6,7.9,9.8,14,20]} }
        };

        function renderTable() {
            const m=document.getElementById('w_mount').value, mat=document.getElementById('w_mat').value, v=document.getElementById('w_volt').value, db=wireData[m][mat];
            let h=''; db.s.forEach((s,x)=>{ h+=`<tr><td>${s}</td><td>${db.i[x]}</td><td>${v=='220'?db.p220[x]:db.p380[x]}</td></tr>`; });
            document.getElementById('w_body').innerHTML=h;
        }

        // –ü–û–¢–ï–†–ò
        function calcLoss() {
            const p=parseFloat(document.getElementById('l_p').value), l=parseFloat(document.getElementById('l_l').value), s=parseFloat(document.getElementById('l_s').value), r=parseFloat(document.getElementById('l_m').value);
            if(!p || !l) return; const dU = (p/220)*(r*2*l/s), dUP = (dU/220)*100, rb=document.getElementById('l_res');
            rb.style.display='block'; rb.className='res-box '+(dUP>5?'warn':'ok');
            document.getElementById('l_val').innerText=dUP.toFixed(2)+'%'; document.getElementById('l_txt').innerText=dUP>5?'–ü—Ä–µ–≤—ã—à–∞–µ—Ç –Ω–æ—Ä–º—É (5%)':'–í –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã';
        }

        // –ú–û–¢–û–†
        function calcMotor() {
            const p=parseFloat(document.getElementById('m_p').value); if(!p) return;
            const c=(document.getElementById('m_type').value==='delta')?p*70:p*45;
            document.getElementById('m_res').style.display='block'; document.getElementById('m_crab').innerText=Math.round(c)+' –º–∫–§'; document.getElementById('m_cpusk').innerText=Math.round(c*2.5)+' –º–∫–§';
        }

        // –°–í–ï–¢ –ò IP
        function calcLight() {
            const a=parseFloat(document.getElementById('li_a').value), l=parseFloat(document.getElementById('li_t').value);
            if(!a) return; document.getElementById('li_res').style.display='block';
            document.getElementById('li_v').innerText=Math.round(a*l*1.2)+' –õ—é–º–µ–Ω';
        }

        function updateIP() {
            const i1=document.getElementById('ip1').value, i2=document.getElementById('ip2').value;
            const d1={'0':'–ù–µ—Ç','2':'–û—Ç –ø–∞–ª—å—Ü–µ–≤','4':'–û—Ç –ø—Ä–æ–≤–æ–ª–æ–∫–∏','5':'–û—Ç –ø—ã–ª–∏','6':'–ü—ã–ª–µ–Ω–µ–ø—Ä–æ–Ω.'}, d2={'0':'–ù–µ—Ç','1':'–ö–∞–ø–ª–∏','4':'–ë—Ä—ã–∑–≥–∏','7':'–ü–æ–≥—Ä—É–∂–µ–Ω–∏–µ','8':'–î–∞–≤–ª–µ–Ω–∏–µ'};
            document.getElementById('ip_desc').innerText='IP'+i1+i2+': '+d1[i1]+' + '+d2[i2];
        }

        // SERVICE WORKER (–û–§–õ–ê–ô–ù)
        if ('serviceWorker' in navigator) {
            const swCode = `
                const CACHE = 'toolbox-v1';
                self.addEventListener('install', e => e.waitUntil(caches.open(CACHE).then(c => c.add('./'))));
                self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))));
            `;
            const blob = new Blob([swCode], {type: 'text/javascript'});
            navigator.serviceWorker.register(URL.createObjectURL(blob));
        }

        renderTable(); updateIP();
    </script>
</body>
</html>
