<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Полный Прайс Электромонтаж 2025</title>
    <style>
        :root { --primary: #1a73e8; --success: #2db855; --danger: #e53935; --dark: #202124; --bg: #f1f3f4; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 140px; color: var(--dark); line-height: 1.4; }
        .header { position: sticky; top: 0; background: var(--primary); color: white; padding: 10px 15px; z-index: 1000; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .search-box { width: 100%; padding: 12px; border-radius: 8px; border: none; font-size: 16px; margin-top: 8px; box-sizing: border-box; outline: none; }
        .container { padding: 10px; max-width: 800px; margin: auto; }
        
        /* Стили разделов */
        .section-box { background: white; border-radius: 10px; margin-bottom: 8px; border: 1px solid #ddd; overflow: hidden; }
        .section-header { padding: 12px 15px; background: #fff; font-weight: 800; font-size: 13px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; text-transform: uppercase; color: #555; }
        .section-header::after { content: '▼'; font-size: 10px; transition: 0.3s; color: var(--primary); }
        .section-box.open .section-header { background: #e8f0fe; color: var(--primary); border-bottom: 1px solid #d2e3fc; }
        .section-box.open .section-header::after { transform: rotate(180deg); }
        .section-content { display: none; padding: 0 15px; }
        .section-box.open .section-content { display: block; }
        
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        .item-row:last-child { border-bottom: none; }
        .item-name { font-size: 13px; font-weight: 500; flex: 1; padding-right: 10px; }
        .item-price { font-weight: 800; color: var(--primary); white-space: nowrap; min-width: 70px; text-align: right; margin-right: 10px; }
        .btn-add { background: var(--success); color: white; border: none; width: 32px; height: 32px; border-radius: 6px; font-size: 20px; cursor: pointer; }

        /* Смета */
        .estimate-card { background: white; border-radius: 12px; padding: 12px; margin-bottom: 8px; border-left: 5px solid var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .qty-inp { width: 60px; padding: 6px; border: 1px solid #ccc; border-radius: 4px; text-align: center; font-weight: bold; }
        .total-amount { font-size: 22px; color: #ffeb3b; font-weight: 900; }
        .footer { position: fixed; bottom: 0; left: 0; right: 0; background: var(--dark); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; z-index: 1001; }
        
        @media print { .no-print { display: none !important; } .section-content { display: block !important; } }
    </style>
</head>
<body>

<div class="header no-print">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <span style="font-weight:900; font-size:14px;">КАЛЬКУЛЯТОР 2025 (33 РАЗДЕЛА)</span>
        <button onclick="resetSmeta()" style="background:rgba(255,255,255,0.2); border:none; color:white; padding:4px 8px; border-radius:4px; font-size:10px;">СБРОСИТЬ</button>
    </div>
    <input type="text" id="search" class="search-box" placeholder="Поиск по всем работам...">
</div>

<div class="container">
    <div id="catalog" class="no-print"></div>
    <h3 style="margin: 20px 10px 10px; border-bottom: 2px solid var(--dark);">ДЕТАЛИЗАЦИЯ СМЕТЫ:</h3>
    <div id="estimate"></div>
</div>

<div class="footer">
    <div>
        <div style="font-size:10px; opacity:0.8;">ИТОГО К ОПЛАТЕ:</div>
        <div class="total-amount"><span id="total">0</span> ₽</div>
    </div>
    <button style="background:var(--primary); color:white; border:none; padding:10px 20px; border-radius:6px; font-weight:bold;" onclick="window.print()">ПЕЧАТЬ</button>
</div>

<script>
const db = [
    { cat: "1. Технологические отверстия", items: [
        {id:"1.1", n:"до Ø20мм Дерево", p:15, u:"п/см"}, {id:"1.2", n:"до Ø20мм Газоблок", p:20, u:"п/см"},
        {id:"1.3", n:"до Ø20мм Кирпич", p:25, u:"п/см"}, {id:"1.4", n:"до Ø20мм Бетон", p:35, u:"п/см"},
        {id:"1.5", n:"до Ø20мм Плита", p:40, u:"п/см"}, {id:"1.6", n:"до Ø36мм Дерево", p:20, u:"п/см"},
        {id:"1.7", n:"до Ø36мм Газоблок", p:25, u:"п/см"}, {id:"1.8", n:"до Ø36мм Кирпич", p:30, u:"п/см"},
        {id:"1.9", n:"до Ø36мм Бетон", p:40, u:"п/см"}, {id:"2.0", n:"до Ø36мм Плита", p:45, u:"п/см"}
    ]},
    { cat: "2. Штробление стен", items: [
        {id:"2.1", n:"Гипсоплита, пеноблок, шт-ка 25х20", p:250, u:"п/м"}, {id:"2.2", n:"Кирпич, шт-ка (цемент) 25х20", p:300, u:"п/м"},
        {id:"2.3", n:"Бетон 25х20", p:400, u:"п/м"}, {id:"2.4", n:"Панельная плита 25х20", p:450, u:"п/м"},
        {id:"2.5", n:"Штроба + монтаж трубы в TV (HDMI)", p:1500, u:"шт"}
    ]},
    { cat: "3. Штробление потолок", items: [
        {id:"3.1", n:"Потолок штукатурка 25х20", p:250, u:"п/м"}, {id:"3.2", n:"Потолок бетон 25х20", p:450, u:"п/м"},
        {id:"3.3", n:"Потолок плита 25х20", p:500, u:"п/м"}
    ]},
    { cat: "4. Монтаж кабеля (Стены)", items: [
          {id:"4.1", n:"Слаботочный (интернет, TV, тел.)", p:80, u:"п/м"},
        {id:"4.2", n:"Силовой 3-х жильный до 2,5 мм²", p:110, u:"п/м"},
        {id:"4.3", n:"Силовой 3-х жильный до 6 мм²", p:140, u:"п/м"},
        {id:"4.4", n:"Силовой 3-х жильный до 16 мм²", p:160, u:"п/м"},
        {id:"4.5", n:"Силовой 4-х жильный до 2,5 мм²", p:150, u:"п/м"},
        {id:"4.6", n:"Силовой 4-х жильный до 6 мм²", p:170, u:"п/м"},
        {id:"4.7", n:"Силовой 4-х жильный до 16 мм²", p:220, u:"п/м"},
        {id:"4.8", n:"Силовой 4-х жильный до 35 мм²", p:280, u:"п/м"},
        {id:"4.9", n:"Силовой 4-х жильный до 50 мм²", p:320, u:"п/м"},
        {id:"4.10", n:"Силовой 4-х жильный до 120 мм²", p:420, u:"п/м"},
        {id:"4.11", n:"Силовой 5-и жильный до 2,5 мм²", p:160, u:"п/м"},
        {id:"4.12", n:"Силовой 5-и жильный до 6 мм²", p:190, u:"п/м"},
        {id:"4.13", n:"Силовой 5-и жильный до 16 мм²", p:250, u:"п/м"},
        {id:"4.14", n:"Силовой 5-и жильный до 120 мм²", p:450, u:"п/м"},
        {id:"4.15", n:"Затягивание кабеля в гофру Ø20", p:70, u:"п/м"},
        {id:"4.16", n:"Затягивание кабеля в гофру Ø25", p:100, u:"п/м"},
        {id:"4.17", n:"Затягивание кабеля в гофру Ø32", p:130, u:"п/м"},
        {id:"4.18", n:"Затягивание кабеля в гофру Ø40", p:160, u:"п/м"},
        {id:"4.19", n:"Затягивание кабеля в гофру Ø50", p:200, u:"п/м"},
        {id:"4.20", n:"Затягивание кабеля в гофру Ø63", p:250, u:"п/м"},
        {id:"4.21", n:"Монтаж трубы ПВХ (клипсы)", p:150, u:"п/м"},
        {id:"4.22", n:"Монтаж Гофра, Металлорукав (клипса, хомут)", p:130, u:"п/м"}
    ]},
    { cat: "5. Монтаж кабеля (Потолок)", items: [
        {id:"5.1", n:"Слаботочный (интернет, TV, тел.) по потолку", p:100, u:"п/м"},
        {id:"5.2", n:"Силовой 3-х жильный до 2,5 мм² по потолку", p:130, u:"п/м"},
        {id:"5.3", n:"Силовой 3-х жильный до 6 мм² по потолку", p:160, u:"п/м"},
        {id:"5.4", n:"Силовой 3-х жильный до 16 мм² по потолку", p:180, u:"п/м"},
        {id:"5.5", n:"Силовой 4-х жильный до 2,5 мм² по потолку", p:170, u:"п/м"},
        {id:"5.6", n:"Силовой 4-х жильный до 6 мм² по потолку", p:190, u:"п/м"},
        {id:"5.7", n:"Силовой 4-х жильный до 16 мм² по потолку", p:240, u:"п/м"},
        {id:"5.8", n:"Силовой 4-х жильный до 35 мм² по потолку", p:300, u:"п/м"},
        {id:"5.9", n:"Силовой 4-х жильный до 50 мм² по потолку", p:340, u:"п/м"},
        {id:"5.10", n:"Силовой 4-х жильный до 120 мм² по потолку", p:440, u:"п/м"},
        {id:"5.11", n:"Силовой 5-и жильный до 2,5 мм² по потолку", p:180, u:"п/м"},
        {id:"5.12", n:"Силовой 5-и жильный до 6 мм² по потолку", p:210, u:"п/м"},
        {id:"5.13", n:"Силовой 5-и жильный до 16 мм² по потолку", p:270, u:"п/м"},
        {id:"5.14", n:"Силовой 5-и жильный до 120 мм² по потолку", p:470, u:"п/м"},
        {id:"5.15", n:"Затягивание в гофру Ø20 (Потолок)", p:90, u:"п/м"},
        {id:"5.16", n:"Затягивание в гофру Ø25 (Потолок)", p:120, u:"п/м"},
        {id:"5.17", n:"Затягивание в гофру Ø32 (Потолок)", p:150, u:"п/м"},
        {id:"5.18", n:"Затягивание в гофру Ø40 (Потолок)", p:180, u:"п/м"},
        {id:"5.19", n:"Затягивание в гофру Ø50 (Потолок)", p:220, u:"п/м"},
        {id:"5.20", n:"Затягивание в гофру Ø63 (Потолок)", p:270, u:"п/м"},
        {id:"5.21", n:"Монтаж трубы ПВХ по потолку (клипсы)", p:170, u:"п/м"},
        {id:"5.22", n:"Монтаж Гофра, Металлорукав по потолку", p:150, u:"п/м"}
    ]},
    { cat: "6. Монтаж провода", items: [
        {id:"6.1", n:"Сечение до 4 мм²", p:100, u:"п/м"},
        {id:"6.2", n:"Сечение до 6 мм²", p:120, u:"п/м"},
        {id:"6.3", n:"Сечение до 10 мм²", p:150, u:"п/м"},
        {id:"6.4", n:"Сечение до 16 мм²", p:170, u:"п/м"},
        {id:"6.5", n:"Сечение до 35 мм²", p:200, u:"п/м"},
        {id:"6.6", n:"Сечение до 50 мм²", p:220, u:"п/м"},
        {id:"6.7", n:"Сечение до 120 мм²", p:250, u:"п/м"}
    ]},
    { cat: "7. Монтаж провода по потолку", items: [
        {id:"7.1", n:"Сечение до 4 мм² (Потолок)", p:120, u:"п/м"},
        {id:"7.2", n:"Сечение до 6 мм² (Потолок)", p:140, u:"п/м"},
        {id:"7.3", n:"Сечение до 10 мм² (Потолок)", p:170, u:"п/м"},
        {id:"7.4", n:"Сечение до 16 мм² (Потолок)", p:190, u:"п/м"},
        {id:"7.5", n:"Сечение до 35 мм² (Потолок)", p:220, u:"п/м"},
        {id:"7.6", n:"Сечение до 50 мм² (Потолок)", p:240, u:"п/м"},
        {id:"7.7", n:"Сечение до 120 мм² (Потолок)", p:270, u:"п/м"}
    ]},
    { cat: "8. Монтаж ретро проводки", items: [
        {id:"8.1", n:"Изолятор (Дерево)", p:50, u:"шт"},
        {id:"8.2", n:"Изолятор (Кирпич, Бетон)", p:100, u:"шт"},
        {id:"8.3", n:"Ретро кабель до 2,5 мм²", p:250, u:"п/м"},
        {id:"8.4", n:"Ретро кабель до 4 мм²", p:350, u:"п/м"},
        {id:"8.5", n:"Распаячная коробка ретро", p:1500, u:"шт"},
        {id:"8.6", n:"Розетка/Выключатель ретро", p:600, u:"шт"}
    ]},
    { cat: "9. Выборка распаячных коробок", items: [
        {id:"9.1", n:"РК ГВЛ, ГКЛ, СМЛ Ø100 мм", p:150, u:"шт"},
        {id:"9.2", n:"РК Газоблок Ø100 мм", p:250, u:"шт"},
        {id:"9.3", n:"РК Кирпич Ø100 мм", p:300, u:"шт"},
        {id:"9.4", n:"РК Бетон Ø100 мм", p:400, u:"шт"},
        {id:"9.5", n:"РК Панельная плита Ø100 мм", p:500, u:"шт"},
        {id:"9.6", n:"Установка РК (вмазка/крепление)", p:150, u:"шт"}
    ]},
    { cat: "10. Расключение распред коробок", items: [
        {id:"10.1", n:"Опрессовка розетки", p:1000, u:"шт"},
        {id:"10.2", n:"Опрессовка проходного выключателя 1 кл", p:1500, u:"шт"},
        {id:"10.3", n:"Опрессовка проходного выключателя 2 кл", p:2000, u:"шт"},
        {id:"10.4", n:"Опрессовка перекрестного выключателя", p:2000, u:"шт"}
    ]},
    { cat: "11. Выборка подрозетников", items: [
        {id:"11.1", n:"Подрозетник ГВЛ, ГКЛ, СМЛ Ø68 мм", p:100, u:"шт"},
        {id:"11.2", n:"Подрозетник Газоблок Ø82 мм", p:150, u:"шт"},
        {id:"11.3", n:"Подрозетник Кирпич Ø82 мм", p:200, u:"шт"},
        {id:"11.4", n:"Подрозетник Бетон Ø82 мм", p:250, u:"шт"},
        {id:"11.5", n:"Подрозетник Панельная плита Ø82 мм", p:350, u:"шт"},
        {id:"11.6", n:"Установка подрозетника (вмазка)", p:150, u:"шт"}
    ]},
    { cat: "12. Выборка и установка щитов", items: [
        {id:"12.1", n:"Установка щита Наружный/Внутренний", p:1500, u:"шт"},
        {id:"12.2", n:"Выборка в Гипсокартоне под щит", p:1000, u:"шт"},
        {id:"12.3", n:"Выборка в Газоблоке (1 мод)", p:150, u:"шт"},
        {id:"12.4", n:"Выборка в Кирпиче (1 мод)", p:200, u:"шт"},
        {id:"12.5", n:"Выборка в Штукатурке цемент (1 мод)", p:200, u:"шт"},
        {id:"12.6", n:"Выборка в Бетоне (1 мод)", p:300, u:"шт"},
        {id:"12.7", n:"Выборка в Панельной плите (1 мод)", p:450, u:"шт"},
        {id:"12.8", n:"Внутренний щит в бетоне 12-24 мод (ниша)", p:3500, u:"шт"},
        {id:"12.9", n:"Внутренний щит в бетоне 36-48 мод (ниша)", p:4500, u:"шт"},
        {id:"12.10", n:"Внутренний щит в бетоне 54-72 мод (ниша)", p:6000, u:"шт"}
    ]},
    { cat: "13. Щиты и Оборудование", items: [
    {id:"13.1", n:"Ввод под напряжением", p:1000, u:"шт"},
        {id:"13.2", n:"Счётчик однофазный", p:2500, u:"шт"},
        {id:"13.3", n:"Счётчик трёхфазный", p:3500, u:"шт"},
        {id:"13.4", n:"ТТ (трансформатор тока) проходной", p:1000, u:"шт"},
        {id:"13.5", n:"ТТ с шиной", p:1800, u:"шт"},
        {id:"13.6", n:"Автомат до 100А (1 модуль)", p:500, u:"шт"},
        {id:"13.7", n:"УЗО 1Ф", p:1500, u:"шт"},
        {id:"13.8", n:"УЗО 3Ф", p:2000, u:"шт"},
        {id:"13.9", n:"РВФ (реле выбора фаз)", p:3500, u:"шт"},
        {id:"13.10", n:"Фазаискатель механический", p:3000, u:"шт"},
        {id:"13.11", n:"РКН (реле контроля напряжения) (1 фазный)", p:1500, u:"шт"},
        {id:"13.12", n:"РКН (реле контроля напряжения) (3 фазный)", p:2000, u:"шт"},
        {id:"13.13", n:"РНПП 302", p:3500, u:"шт"},
        {id:"13.14", n:"РКФ (реле контроля фаз)", p:2500, u:"шт"},
        {id:"13.15", n:"Байпас 1ф", p:2000, u:"шт"},
        {id:"13.16", n:"Байпас 3ф", p:2500, u:"шт"},
        {id:"13.17", n:"МДП 1й", p:600, u:"шт"},
        {id:"13.18", n:"МДП 2й", p:1000, u:"шт"},
        {id:"13.19", n:"МДП 3й", p:1500, u:"шт"},
        {id:"13.20", n:"Индикатор напряжения (лсм) 1Ф", p:500, u:"шт"},
        {id:"13.21", n:"Индикатор напряжения (лсм) 2Ф", p:1000, u:"шт"},
        {id:"13.22", n:"Индикатор напряжения (лсм) 3Ф", p:1500, u:"шт"},
        {id:"13.23", n:"Вольтамперметр 1Ф", p:1000, u:"шт"},
        {id:"13.24", n:"Вольтамперметр 3Ф", p:1500, u:"шт"},
        {id:"13.25", n:"Шина нулевая до 125A", p:800, u:"шт"},
        {id:"13.26", n:"РБ (распределительный блок) до 150A", p:1000, u:"шт"},
        {id:"13.27", n:"РБ (распределительный блок) до 400А", p:1800, u:"шт"},
        {id:"13.28", n:"Розетка на динрейку", p:300, u:"шт"},
        {id:"13.29", n:"Розетка наружная", p:500, u:"шт"},
        {id:"13.30", n:"Блок питания на дин рейку 12-24-36V", p:1000, u:"шт"},
        {id:"13.31", n:"Вводная клемма", p:700, u:"шт"},
        {id:"13.32", n:"Кросс модуль 2 рядный", p:1200, u:"шт"},
        {id:"13.33", n:"Кросс модуль 3 рядный", p:1700, u:"шт"},
        {id:"13.34", n:"Кросс модуль 4 рядный", p:2200, u:"шт"},
        {id:"13.35", n:"Контактор 2х полюсный (модульный)", p:2000, u:"шт"},
        {id:"13.36", n:"Контактор 4х полюсный (модульный)", p:2500, u:"шт"},
        {id:"13.37", n:"Контактор 2NO 2NC (модульный)", p:3000, u:"шт"},
        {id:"13.38", n:"Промежуточное реле", p:3000, u:"шт"},
        {id:"13.39", n:"Магнитный пускатель до 63А (пром)", p:2500, u:"шт"},
        {id:"13.40", n:"Магнитный пускатель до 160А (пром)", p:3500, u:"шт"},
        {id:"13.41", n:"Магнитный пускатель до 250А (пром)", p:4500, u:"шт"},
        {id:"13.42", n:"Магнитный пускатель до 400А (пром)", p:5000, u:"шт"},
        {id:"13.43", n:"Магнитный пускатель до 630А (пром)", p:5500, u:"шт"},
        {id:"13.44", n:"Магнитный пускатель 2NO 2NC до 125А (пром)", p:4000, u:"шт"},
        {id:"13.45", n:"Доп. Контактор на пром. Контактор", p:1500, u:"шт"},
        {id:"13.46", n:"ВА (пром) до 100А", p:3000, u:"шт"},
        {id:"13.47", n:"ВА (пром) до 160А", p:3000, u:"шт"},
        {id:"13.48", n:"ВА (пром) до 250А", p:3500, u:"шт"},
        {id:"13.49", n:"ВА (пром) до 400А", p:4500, u:"шт"},
        {id:"13.50", n:"ВА (пром) до 630А", p:7000, u:"шт"},
        {id:"13.51", n:"Рубильник до 630А", p:7500, u:"шт"},
        {id:"13.52", n:"Рубильник реверсивный до 630А", p:8000, u:"шт"},
        {id:"13.53", n:"OM, PMT", p:2000, u:"шт"},
        {id:"13.54", n:"Импульсное реле 2х полюсное", p:1500, u:"шт"},
        {id:"13.55", n:"Импульсное реле 4х полюсное", p:2000, u:"шт"},
        {id:"13.56", n:"Астрономическое реле", p:2500, u:"шт"},
        {id:"13.57", n:"Реле времени", p:2000, u:"шт"},
        {id:"13.58", n:"УЗИП (ОПН) 1Ф", p:2500, u:"шт"},
        {id:"13.59", n:"Держатель плавких предохранителей 1Ф", p:2500, u:"шт"},
        {id:"13.60", n:"УЗИП (ОПН) 3Ф", p:3500, u:"шт"},
        {id:"13.61", n:"Держатель плавких предохранителей 3Ф", p:3500, u:"шт"},
        {id:"13.62", n:"Диммер сигнала УЗИП", p:500, u:"шт"},
        {id:"13.63", n:"ПЛК (контроллер)", p:14000, u:"шт"},
        {id:"13.63_2", n:"Частотный преобразователь до 3кВт", p:8000, u:"шт"},
        {id:"13.64", n:"Частотный преобразователь выше 3кВт", p:14000, u:"шт"},
        {id:"13.65", n:"Термо реле", p:1000, u:"шт"},
        {id:"13.66", n:"Куллер", p:1000, u:"шт"},
        {id:"13.67", n:"Фильтр решётки притока", p:300, u:"шт"},
        {id:"13.68", n:"Концевик", p:700, u:"шт"},
        {id:"13.69", n:"Кнопка пуск-стоп", p:800, u:"шт"},
        {id:"13.70", n:"Гермоввод", p:300, u:"шт"},
        {id:"13.71", n:"Техотверстие под куллер в эл.щите", p:1500, u:"шт"},
        {id:"13.72", n:"Техотверстие в щите до 24мм", p:800, u:"шт"},
        {id:"13.73", n:"Техотверстие в щите до 36мм", p:1000, u:"шт"}
    ]},
    { cat: "14. Опрессовка гильзами", items: [
     
        {id:"14.18", n:"Провод (до 2,5 мм² сечения 1 жила)", p:200, u:"шт"},
        {id:"14.19", n:"Провод (до 6 мм² сечения 1 жила)", p:250, u:"шт"},
        {id:"14.20", n:"Провод (до 16 мм² сечения 1 жила)", p:300, u:"шт"},
        {id:"14.21", n:"Провод (до 35 мм² сечения 1 жила)", p:550, u:"шт"},
        {id:"14.22", n:"Провод (до 90 мм² сечения 1 жила)", p:700, u:"шт"},
        {id:"14.23", n:"Провод (до 120 мм² сечения 1 жила)", p:800, u:"шт"},
        {id:"14.24", n:"Провод (150-185 мм² сечения 1 жила)", p:900, u:"шт"},
        {id:"14.25", n:"Провод (240 мм² сечения 1 жила)", p:1000, u:"шт"},
        {id:"14.26", n:"Провод (300 мм² сечения 1 жила)", p:1500, u:"шт"}
    ]},
    { cat: "15. Розетки и выключатели", items: [
        {id:"15.1", n:"Розетка, выключатель наружный", p:300, u:"шт"},
        {id:"15.2", n:"Розетка, выключатель внутренний", p:200, u:"шт"},
        {id:"15.3", n:"Розетка, выключатель шлейфом", p:250, u:"шт"},
        {id:"15.4", n:"Розетка компьютерная 1-я", p:350, u:"шт"},
        {id:"15.5", n:"Розетка компьютерная 2-я", p:500, u:"шт"},
        {id:"15.6", n:"Розетка, выключатель наружный 220в", p:350, u:"шт"},
        {id:"15.7", n:"Розетка 380в", p:9000, u:"шт"},
        {id:"15.8", n:"Вилка для электроприбора 220в", p:200, u:"шт"},
        {id:"15.9", n:"Вилка для электроприбора 380в", p:600, u:"шт"},
        {id:"15.10", n:"Проходной переключатель 1 кл.", p:300, u:"шт"},
        {id:"15.11", n:"Проходной переключатель 2 кл.", p:400, u:"шт"},
        {id:"15.12", n:"Перекрёстный переключатель 1 кл.", p:500, u:"шт"},
        {id:"15.13", n:"Перекрёстный переключатель 2 кл.", p:700, u:"шт"},
        {id:"15.14", n:"Диммер (светорегулятор)", p:500, u:"шт"},
        {id:"15.15", n:"Реостат для пола (терморегулятор)", p:1500, u:"шт"},
        {id:"15.16", n:"Электронный замок", p:3000, u:"шт"},
        {id:"15.17", n:"Роз. Вкл. Наружные временные", p:150, u:"шт"}
    ]},
    { cat: "16. Монтаж светодиодной ленты", items: [
        {id:"16.1", n:"Контроллер, диммер, усилитель", p:1000, u:"шт"},
        {id:"16.2", n:"Светодиодная лента", p:400, u:"п/м"},
        {id:"16.3", n:"Светодиодная лента (RGB, RGBW)", p:550, u:"п/м"},
        {id:"16.4", n:"Блок питания для ленты", p:1000, u:"шт"},
        {id:"16.5", n:"Профиль алюминиевый (накладной/врезной)", p:500, u:"п/м"},
        {id:"16.6", n:"Профиль алюминиевый (угловой)", p:600, u:"п/м"},
        {id:"16.7", n:"Экран (рассеиватель) монтаж", p:100, u:"п/м"},
        {id:"16.8", n:"Пайка контактов ленты", p:300, u:"шт"},
        {id:"16.9", n:"Коннектор для ленты", p:150, u:"шт"},
        {id:"16.10", n:"усилитель", p:2000, u:"шт"}
    ]},
    { cat: "17. Осветительные приборы", items: [
        {id:"17.1", n:"Светильник Армстронг", p:800, u:"шт"},
        {id:"17.2", n:"Светильник накладной (простой)", p:500, u:"шт"},
        {id:"17.3", n:"Светильник накладной (сложный/дизайнерский)", p:1200, u:"шт"},
        {id:"17.4", n:"Светильник ЖКХ (с датчиком)", p:600, u:"шт"},
        {id:"17.5", n:"Прожектор светодиодный", p:1500, u:"шт"},
        {id:"17.6", n:"Встраиваемый светильник (точечный)", p:500, u:"шт"},
        {id:"17.7", n:"Встраиваемый светильник (в бетон/кирпич)", p:1200, u:"шт"},
        {id:"17.8", n:"Трековый светильник (за 1 шт на шине)", p:400, u:"шт"},
        {id:"17.9", n:"Шинопровод для трековых светильников", p:800, u:"п/м"},
        {id:"17.10", n:"Бра, настенный светильник", p:1000, u:"шт"},
        {id:"17.11", n:"Световая линия (в ГКЛ/натяжной)", p:2500, u:"п/м"},
        {id:"17.12", n:"Люстра простая (до 3-х рожков)", p:2500, u:"шт"},
        {id:"17.13", n:"Люстра сложная/сборка (от 3-х рожков)", p:4000, u:"шт"},
        {id:"17.14", n:"Люстра хрустальная/элитная", p:7000, u:"шт"},
        {id:"17.15", n:"Замена ламп", p:100, u:"шт"},
        {id:"17.16", n:"Замена патрона в светильнике", p:300, u:"шт"},
        {id:"17.17", n:"Сборка светильника/люстры", p:1500, u:"шт"},
        {id:"17.18", n:"Уличный светильник на столб", p:3500, u:"шт"},
        {id:"17.19", n:"Подсветка фасада (архитектурная)", p:2000, u:"шт"},
        {id:"17.20", n:"Датчик движения / Фотореле", p:1500, u:"шт "},
        {id:"17.21", n:"фотореле (с выносным датчиком)", p:2000, u:"шт"},
        {id:"17.22", n:"фасадный светильник", p:1500, u:"шт"},
        {id:"17.23", n:"ландшафтный светильник", p:2000, u:"шт"}
    ]},
    { cat: "18. Вентиляция", items: [
        {id:"18.1", n:"Вентилятор вытяжной (монтаж)", p:2000, u:"шт"},
        {id:"18.2", n:"Вентилятор с таймером/датчиком (настройка)", p:2500, u:"шт"},
        {id:"18.3", n:"Прокладка гибкого воздуховода до Ø150мм", p:400, u:"п/м"}
    ]},
   { cat: "19. Монтаж теплого пола", items: [
        {id:"19.1", n:"монтаж теплого пола", p:1500, u:"п/м"},
        {id:"19.2", n:"термодатчик ", p:1500, u:"п/м"},
    ]},
  
    { cat: "20. Кабель-канал (Стены Кирпич, Бетон)", items: [
        {id:"20.1", n:"Кабель-канал до 16х25", p:200, u:"п/м"},
        {id:"20.2", n:"Кабель-канал до 40х40", p:250, u:"п/м"},
        {id:"20.3", n:"Кабель-канал до 100х60", p:400, u:"п/м"}
    ]},
    { cat: "21. Кабель-канал (Потолок дерево)", items: [
        {id:"21.1", n:"Кабель-канал до 16х25", p:150, u:"п/м"},
        {id:"21.2", n:"Кабель-канал до 40х40", p:200, u:"п/м"},
        {id:"21.3", n:"Кабель-канал до 100х60", p:350, u:"п/м"}
    ]},
    { cat: "22. Кабель-канал (Потолок бетон)", items: [
        {id:"22.1", n:"Кабель-канал до 16х25", p:250, u:"п/м"},
        {id:"22.2", n:"Кабель-канал до 40х40", p:350, u:"п/м"},
        {id:"22.3", n:"Кабель-канал до 100х60", p:500, u:"п/м"}
    ]},
    { cat: "23. Лоток металлический", items: [
        {id:"23.1", n:"Лоток до 200 мм", p:300, u:"п/м"},
        {id:"23.2", n:"Лоток до 400 мм", p:500, u:"п/м"},
        {id:"23.3", n:"Лоток до 600 мм", p:800, u:"п/м"},
        {id:"23.4", n:"Крышка лотка", p:100, u:"п/м"},
        {id:"23.5", n:"Перегородка в лоток", p:150, u:"п/м"},
        {id:"23.6", n:"Шпилька/подвес для лотка", p:350, u:"шт"},
        {id:"23.7", n:"Кронштейн стеновой", p:300, u:"шт"}
    ]},
    { cat: "24. Труба ПНД (в земле)", items: [
        {id:"24.1", n:"Труба ПНД до Ø40", p:150, u:"п/м"},
        {id:"24.2", n:"Труба ПНД до Ø63", p:200, u:"п/м"},
        {id:"24.3", n:"Труба ПНД до Ø110", p:350, u:"п/м"},
        {id:"24.4", n:"Сигнальная лента", p:50, u:"п/м"}
    ]},
    { cat: "25. Заземление (Контур)", items: [
        {id:"25.1", n:"Заземлитель вертик. Ø18-20 (L=1.5м)", p:1500, u:"шт"},
        {id:"25.2", n:"Полоса заземления (монтаж)", p:350, u:"п/м"},
        {id:"25.3", n:"Сварка стыка контура", p:800, u:"шт"},
        {id:"25.4", n:"Окраска мест сварки", p:150, u:"шт"},
        {id:"25.5", n:"Подключение к ГЗШ", p:1500, u:"шт"}
    ]},
    { cat: "26. Земляные работы", items: [
        {id:"26.1", n:"Траншея 0.7м (песок/грунт)", p:500, u:"п/м"},
        {id:"26.2", n:"Траншея 0.7м (глина/щебень)", p:800, u:"п/м"},
        {id:"26.3", n:"Обратная засыпка с трамбовкой", p:300, u:"п/м"},
        {id:"26.4", n:"Устройство постели из песка", p:200, u:"п/м"},
        {id:"26.5", n:"Прокол под дорогой (ручной)", p:5000, u:"п/м"},
        {id:"26.6", n:"Измерение сопротивления контура", p:3000, u:"шт"}
    ]},
    { cat: "27. Монтаж СИП", items: [
        {id:"27.1", n:"СИП 2х16, 2х25 (по опорам/фасаду)", p:250, u:"п/м"},
        {id:"27.2", n:"СИП 4х16, 4х25 (по опорам/фасаду)", p:300, u:"п/м"},
        {id:"27.3", n:"СИП 4х35, 4х50 (по опорам/фасаду)", p:400, u:"п/м"},
        {id:"27.4", n:"СИП 4х70, 4х95 (по опорам/фасаду)", p:500, u:"п/м"},
        {id:"27.5", n:"Установка анкерного зажима (натяжка)", p:800, u:"шт"},
        {id:"27.6", n:"Установка прокола (ответвление)", p:600, u:"шт"},
        {id:"27.7", n:"Раскатка кабеля СИП", p:100, u:"п/м"},
        {id:"27.8", n:"Монтаж крюка на опору/фасад", p:1200, u:"шт"},
        {id:"27.9", n:"Установка опоры ЛЭП (работа)", p:12000, u:"шт"},
        {id:"27.10", n:"Опора h11м (комплекс: доставка, установка)", p:18000, u:"шт"}
    ]},
    { cat: "28. Монтаж кабельных муфт", items: [
        {id:"28.1", n:"Муфта концевая до 95 мм²", p:5000, u:"шт"},
        {id:"28.2", n:"Муфта концевая до 240 мм²", p:8000, u:"шт"},
        {id:"28.3", n:"Муфта соединительная до 95 мм²", p:8000, u:"шт"},
        {id:"28.4", n:"Муфта соединительная до 240 мм²", p:12000, u:"шт"},
        {id:"28.5", n:"Термоусадочная перчатка", p:2500, u:"шт"}
    ]},
    { cat: "29. Монтаж наконечников (ТМЛ/ТА)", items: [
        {id:"29.1", n:"Наконечник до 16 мм² (опрессовка)", p:400, u:"шт"},
        {id:"29.2", n:"Наконечник до 50 мм² (опрессовка)", p:600, u:"шт"},
        {id:"29.3", n:"Наконечник до 120 мм² (опрессовка)", p:1000, u:"шт"},
        {id:"29.4", n:"Наконечник до 240 мм² (опрессовка)", p:1500, u:"шт"},
        {id:"29.5", n:"Срывной болтовой наконечник", p:1200, u:"шт"}
    ]},
    { cat: "30. Техническое обслуживание", items: [
        {id:"30.1", n:"Протяжка контактов в щите (1 мод)", p:100, u:"шт"},
        {id:"30.2", n:"Замена шины (Алюминий)", p:2000, u:"п/м"},
        {id:"30.3", n:"Замена шины (Медь)", p:2500, u:"п/м"},
        {id:"30.4", n:"Замена губы плавкой вставки", p:1000, u:"шт"},
        {id:"30.5", n:"Замена плавкой вставки", p:150, u:"шт"}
    ]},
    { cat: "31. Подключение генератора", items: [
        {id:"31.1", n:"Переносной до 15 кВт", p:8000, u:"шт"},
        {id:"31.2", n:"Переносной с АВР до 15 кВт", p:15000, u:"шт"},
        {id:"31.3", n:"Стационарный", p:20000, u:"шт"},
        {id:"31.4", n:"Стационарный с АВР", p:25000, u:"шт"}
    ]},
    { cat: "32. Выезд специалиста", items: [
        {id:"32.1", n:"Выезд до 18:00", p:500, u:"шт"},
        {id:"32.2", n:"Выезд с 18:00 до 21:00", p:1000, u:"шт"},
        {id:"32.3", n:"Выезд с 21:00 до 23:00", p:1500, u:"шт"},
        {id:"32.4", n:"Выезд после 23:00", p:2000, u:"шт"},
        {id:"32.5", n:"Выезд за город (доп. к чеку)", p:50, u:"км"},
        {id:"32.6", n:"Выезд Инженера (консультация)", p:1000, u:"шт"}
    ]},
    { cat: "33. Коэффициенты и Демонтаж", items: [
        {id:"33.1", n:"Стесненность / Высота (x2.5)", p:2.5, u:"коэф"},
        {id:"33.2", n:"Сложные погодные условия (x1.5)", p:1.5, u:"коэф"},
        {id:"33.3", n:"Работа под напряжением (x2.5)", p:2.5, u:"коэф"},
        {id:"33.4", n:"Расчет сметы (за 1 м² объекта)", p:100, u:"м²"},
        {id:"33.5", n:"Закупка и доставка материала (от чека)", p:10, u:"%"},
        {id:"33.6", n:"Срочный вызов (аварийный)", p:2000, u:"шт"},
        {id:"33.7", n:"Демонтаж (50% от стоимости монтажа)", p:50, u:"%"}
    ]}
];

let state = JSON.parse(localStorage.getItem('smeta_full_2025')) || [];

function renderCatalog(filter = "") {
    const list = document.getElementById('catalog');
    list.innerHTML = "";
    db.forEach(sec => {
        const items = sec.items.filter(i => i.n.toLowerCase().includes(filter.toLowerCase()));
        if (!items.length) return;
        const box = document.createElement('div');
        box.className = 'section-box' + (filter ? ' open' : '');
        box.innerHTML = `<div class="section-header" onclick="this.parentElement.classList.toggle('open')">${sec.cat}</div>`;
        const content = document.createElement('div');
        content.className = 'section-content';
        items.forEach(item => {
            content.innerHTML += `
                <div class="item-row">
                    <div class="item-name">${item.n} <br><small style="color:#888">ед: ${item.u}</small></div>
                    <div class="item-price">${item.p} ₽</div>
                    <button class="btn-add" onclick="addItem('${item.id}')">+</button>
                </div>`;
        });
        box.appendChild(content);
        list.appendChild(box);
    });
}

function addItem(id) {
    let raw;
    db.forEach(s => s.items.forEach(i => { if(i.id === id) raw = i; }));
    state.push({ ...raw, qty: 1, k: false, uid: Date.now() });
    sync();
}

function sync() {
    localStorage.setItem('smeta_full_2025', JSON.stringify(state));
    const list = document.getElementById('estimate');
    let total = 0;
    list.innerHTML = state.map((item, i) => {
        const isKoef = (item.u === 'коэф' || item.u === '%');
        const price = item.k ? (item.p * 2.5) : item.p;
        const sum = isKoef ? (price * (state[0]?.p || 0) * item.qty / 100) : (price * item.qty);
        // Упрощенная логика суммы для наглядности
        const finalSum = item.u === 'коэф' ? 0 : price * item.qty; 
        total += finalSum;
        return `
            <div class="estimate-card">
                <div style="display:flex; justify-content:space-between; font-weight:bold; margin-bottom:8px;">
                    <span>${item.n}</span>
                    <span style="color:var(--danger); cursor:pointer" onclick="remove(${i})">✕</span>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <input type="number" class="qty-inp" value="${item.qty}" onchange="editQty(${i}, this.value)">
                        ${item.u !== 'коэф' ? `<label style="font-size:10px; background:#e8f0fe; padding:4px; border-radius:4px;"><input type="checkbox" ${item.k?'checked':''} onchange="toggleK(${i})"> x2.5</label>` : ''}
                    </div>
                    <div style="font-size:18px; font-weight:900;">${finalSum.toLocaleString()} ₽</div>
                </div>
            </div>`;
    }).join('');
    document.getElementById('total').innerText = total.toLocaleString();
}

window.editQty = (i, v) => { state[i].qty = parseFloat(v) || 0; sync(); }
window.toggleK = (i) => { state[i].k = !state[i].k; sync(); }
window.remove = (i) => { state.splice(i, 1); sync(); }
window.resetSmeta = () => { if(confirm("Очистить все?")) { state = []; sync(); } }
document.getElementById('search').addEventListener('input', e => renderCatalog(e.target.value));
renderCatalog();
sync();
</script>
</body>
</html>
